import React, { useState, useMemo } from 'react';
import { BrazilStateMetric } from '../types';

// SVG Paths for Brazilian States (Simplified for performance but recognizable)
const statePaths: { [key: string]: string } = {
    AC: "M127.8,368.4l-2.2-3.2l-9.5,0.5l-4.3,7.6l-11.9,0l-5.4,5.4l-3.8-1.1l-2.7,2.7l-7.6-1.1l-6.5,2.2l-2.7-1.6l-7,1.1l-2.2,4.9l-6.5-0.5l-2.2,2.7l-7.6,1.1l-3.2-2.2l-2.2,1.6l-5.4,1.1l-1.1-1.6l-2.7,1.6l-3.2-1.1l-1.6,2.7l-5.4-1.1l-2.7,1.6l-1.1,5.9l5.4,1.6l4.3-0.5l2.7,2.7l1.1,3.2l5.9,2.7l3.8-1.1l2.2,3.2l3.2-1.1l5.4,4.3l9.2,0.5l7,1.6l3.2,4.3l6.5-3.2l10.3,2.2l2.2,4.3l8.1-3.8l4.9,2.2l4.3-1.1l5.9,2.7l3.2-2.2l5.4,1.1l4.3-2.7l3.8,1.6l3.2-3.2l2.2-7l3.8-4.3l1.6-4.9l-2.7-2.2l-0.5-4.9l-3.8-3.2l-4.9,0.5L127.8,368.4z",
    AL: "M852.4,441.4l-8.1-1.6l-4.3-3.8l-1.6,1.6l-5.4-0.5l-4.3,1.6l-5.4-1.6l-3.8,1.6l-2.2,2.7l-0.5,4.3l8.1,3.2l5.4-1.1l5.9,1.1l2.7,3.2l2.2-1.6l4.9,0.5l3.8-2.2l2.2-2.2L852.4,441.4z",
    AM: "M254.4,275.4l-2.2-5.4l-11.9-2.7l-8.1,1.6l-2.2,6.5l-5.4-2.2l-5.4,3.2l-7-3.2l-2.2-2.7l-2.2,2.7l-7-1.1l-5.9-5.4l-3.8,2.7l-3.8-1.1l-2.7,2.2l-1.6-1.6l-2.7,0.5l-2.2-2.2l-3.8,2.2l-0.5,2.2l-5.4,1.6l-3.8-0.5l-5.4-5.4l-6.5,2.7l-4.9-3.2l-4.9,1.6l-4.3-1.1l-1.6-4.3l-5.9,0.5l-5.4-2.2l-2.7,2.2l-8.1-2.7l-4.3,1.6l-0.5,4.3l-3.8,3.8l-3.8-1.6l-5.4,4.3l-7-0.5l-2.7-3.2l-10.3,3.2l-3.8-3.2l-8.1,3.8l-4.3-1.6l-3.2,2.7l-8.6-2.2l-5.9,2.7l-4.3-1.1l-2.7-3.8l-5.9,1.1l-2.7-2.2l-1.6,1.6l-5.4-3.2l-3.2,1.6l-5.4-2.2l-3.8,2.2l-6.5-1.6l-4.3,2.2l-5.4-2.2l-2.7-2.7l3.2-3.8l3.8-3.8l3.2,0l3.8-3.8l4.9,0.5l4.3-3.2l10.3-1.6l3.8-6.5l1.6-7.6l8.1-8.1l1.1-7.6l-2.2-3.2l-5.9-2.2l-0.5-3.8l4.9-2.2l3.2-4.3l-1.6-2.7l1.1-3.8l7-3.2l8.1-1.1l4.9,3.2l2.7-2.7l4.3,2.7l5.4-2.2l7,2.7l4.3,6.5l5.4,0l7,4.9l2.2,5.4l2.2,1.1l4.3-3.8l3.8,0.5l2.7,3.2l3.8,1.1l0.5-3.8l2.7-2.2l5.4,1.1l1.6-3.2l5.9-2.7l4.3,1.1l2.7-1.1l1.1,3.2l4.9,0.5l2.2-2.7l5.4,1.1l3.8-2.7l2.2,1.6l3.8-1.1l1.1,4.3l4.3-1.1l1.1,3.2l4.3,2.2l4.3-2.2l7.6,3.8l3.2-2.2l5.9,1.6l8.1-1.6l10.8,2.7l4.3,4.3l2.7,10.3l-1.6,5.9l-1.6,1.6l1.6,7.6l4.9,3.8l3.8-1.6l2.2,3.8l2.7,0.5l2.7-2.7l5.4,3.2l2.7-1.6l6.5,2.2l1.6-2.2l3.8,2.2l3.8-1.6l1.6,2.2l3.8,0l2.7,3.2l5.4-1.1l4.3,2.2l3.2-3.2l3.8,2.2l-3.2,5.9l-5.4,3.2l-3.2,7l1.1,3.8l-1.6,3.2l-5.4,3.8l-2.7,4.9l-5.9,2.7l-6.5,0l-3.8-2.7l-2.7,2.2l-0.5,4.9l-4.3,2.2l-1.6,3.8l-3.2,1.1l-0.5,3.8l-3.8,2.7l-4.9,1.1l-2.2,3.2l-4.3,0.5l-3.8,3.2l-3.8,1.6l-7,0l-6.5-2.7l-5.4,1.1l-4.3-2.2l-4.3,1.6l-1.1-2.7l-4.3-0.5l-2.7-3.8l-1.6,2.7l-4.9-0.5l-3.8-3.2l-2.2,2.2l-4.3-1.6l-5.9,2.2l-4.9,1.6l-0.5-3.8l-3.8-2.2l-1.1-3.2l1.1-3.2l4.9-1.6l2.2-5.4l-2.7-1.1l-2.2,3.8l-5.4-2.2L254.4,275.4z",
    AP: "M514,87.7l-2.2,5.4l-1.6-2.7l-5.9-1.6l-2.2,2.2l-3.8-2.2l-7,2.2l-2.2-1.1l-3.2,2.2l-7.6-1.6l-5.4-2.7l-4.3,2.7l-1.6-2.2l-2.7,1.6l-1.6-1.6l2.2-7l-2.2-2.2l-3.8,1.1l-0.5-4.3l-2.7-3.2l1.6-3.2l7.6-1.6l5.9,1.1l2.2-2.2l3.8,0.5l1.1-3.2l6.5-2.7l3.8-4.3l4.9,0l2.2,2.7l4.3,1.6l2.7,3.2l1.6,3.8l4.9,1.6l3.2,6.5l4.9,3.2L514,87.7z",
    BA: "M768.2,453.3l-3.8,1.1l-3.8-3.8l-6.5,1.1l-3.2-1.6l-2.7,2.7l-4.3,0.5l-4.9-3.8l-1.6-5.4l-5.4-4.9l-5.4,1.6l-4.3-1.1l-2.7-3.2l-3.8,1.1l-4.3-1.1l-7,3.2l-6.5-2.7l-5.9,3.2l-5.4-1.1l-3.8,1.6l-4.3-2.2l-4.3,0.5l-8.1,4.9l-10.3-5.4l-5.9,0.5l-11.9,10.8l-10.8-1.1l-2.7,5.9l-2.7-1.1l-2.2,1.6l-5.4-1.1l-4.9,1.6l-6.5-2.2l-3.8,2.2l-5.9-0.5l-2.7,2.7l-3.8-1.1l-7,4.3l-1.6,4.3l2.7,5.4l5.9,0l4.3,5.9l4.9,1.1l4.3,6.5l-1.6,6.5l3.8,2.2l1.6,4.9l4.9,0l2.2,3.2l10.3,2.2l3.2,5.4l4.9,2.7l3.2,3.8l11.4-2.7l2.7-3.8l4.3,0.5l4.9,6.5l5.4,1.1l8.1-1.6l5.9,2.2l3.2-3.8l5.9,1.6l3.8-3.8l7,0.5l4.3-1.6l1.1,2.2l3.8-1.1l4.9,2.2l5.9,0l4.3-2.2l5.9,1.6l2.2-1.6l5.4,1.1l1.6-2.7l4.3,1.6l5.4-1.6l2.7-4.3l1.1,3.8l1.6-1.6l4.3,1.6l5.4-0.5l0.5-7l3.8-1.1l1.1-4.3l5.4-1.6l0.5-3.8l3.8-1.6l0.5-3.8l2.7-4.3l-2.7-3.2l2.2-3.8l4.9-0.5l2.7-5.4l-2.7-1.6l-1.1-3.8l-4.9-4.9l-5.9-2.7l-3.8-3.8l-4.3,1.1L768.2,453.3z",
    CE: "M831.4,212.8l-4.3,1.6l-1.6-4.9l-5.9,1.1l-4.3-2.7l-7,1.1l-3.8-1.6l-4.3,1.6l-5.4-2.7l-5.4,1.1l-5.4-2.2l-4.3,1.6l-3.8-3.2l-4.9,2.2l-4.3-1.6l-4.9,0l-2.2,4.3l-7-1.6l-1.1-3.8l4.3-5.4l2.2-6.5l4.9-1.6l5.9,2.7l5.4-1.1l2.7-3.8l5.9-2.2l6.5,2.2l5.9-1.1l4.3,2.7l3.2-2.2l5.9,2.7l5.4-2.2l5.9,2.7l4.9-2.7l4.3,3.8l5.9,10.3L831.4,212.8z",
    DF: "M634.5,438.7l-4.3,0.5l-0.5-3.2l2.2-2.2l3.8,0.5l2.2,2.7L634.5,438.7z",
    ES: "M820.6,533.7l-3.8,0.5l-4.9-2.2l-3.2,2.2l-4.3-1.6l-0.5,3.2l-5.9-1.1l-1.6-2.7l-4.3,1.1l-2.2,3.8l-4.3-2.2l-2.7,2.2l-0.5,4.9l2.7,3.8l5.4,1.1l1.1,3.8l3.8,1.1l0.5,5.9l2.2-1.1l2.7-4.3l3.8-1.6l2.2-4.3l4.3-3.2l3.8,1.6l3.8-3.2l2.2-5.4L820.6,533.7z",
    GO: "M636.1,397.7l-2.7,3.2l-4.9-1.1l-2.7-3.8l-8.1-1.1l-4.9,2.2l-6.5-2.7l-4.3,1.6l-5.4-3.2l-1.6,1.6l-3.8-1.1l-3.2,1.6l-4.9-1.1l-3.8,1.1l-3.8-3.2l-2.2,1.6l-3.2-1.6l-2.2,2.7l-4.9,0.5l-3.8-2.2l-0.5,3.8l-4.3,0.5l-2.2,3.2l-5.9,1.1l-4.3-2.2l-2.2,1.6l-4.3-1.1l-1.6,2.7l-6.5,0l-2.7,4.3l2.2,5.4l5.4,1.1l4.3,6.5l-2.7,3.8l1.6,4.3l4.9,4.3l5.4-2.2l3.8,4.3l7,2.2l3.2-2.2l3.8,1.1l2.7,5.9l6.5,1.1l3.8,7l11.4,2.7l3.2,5.9l4.3,0.5l3.2-3.8l6.5,2.2l1.6-3.2l4.3,0l3.8-4.9l5.9-2.2l2.7-3.8l5.4,0.5l3.2-2.2l-2.2-2.7l-3.8-0.5l-2.2,2.2l0.5,3.2l4.3-0.5l4.3-2.2l2.7-3.8l4.9,2.7l3.8-3.8l-4.9-10.8l2.2-4.3l0.5-7l-1.1-3.2l-5.4-1.6l-2.2-4.3L636.1,397.7z",
    MA: "M698.2,195l-4.9,0l-2.2-5.9l-3.8,1.1l-4.3-2.7l-7,3.2l-2.2-2.2l-3.2,1.6l-3.2-3.2l-2.2,2.2l-4.9-3.2l-5.4,3.2l-5.4,10.3l-2.2,0.5l-2.2-2.2l-3.2,1.6l-2.7-2.7l-3.8,0l-2.2-3.8l-4.3,1.6l-2.7-2.2l-3.2,2.2l-2.2-2.7l-5.9,3.2l-4.9-1.6l-5.4,4.9l-1.6-2.7l-3.2,1.1l-2.2-1.6l-1.6,1.6l-4.3,0l-5.4,5.9l0.5,3.8l7,3.2l4.3,6.5l5.4,1.6l2.2,4.9l3.8-0.5l1.1,3.8l-2.2,4.3l3.2,2.7l0.5,4.3l-3.2,2.2l1.1,2.7l4.9,0.5l2.2,2.7l3.8-1.6l3.2,3.2l5.9-1.6l3.2,1.6l3.2-1.6l4.3,1.6l2.7-2.2l4.9,0.5l2.7,2.7l3.8-1.1l7,3.2l1.6-3.2l2.7-1.6l4.9,1.1l7-4.3l7-10.3l1.6-4.9l3.8-3.8l1.6-5.9l6.5-4.3l1.1-3.8l4.9-2.7l3.2,1.6l2.2-3.8l4.9-0.5l0.5-4.9l-2.7-1.1l-2.7,2.2l-3.8-2.2l-0.5-3.8l-4.9-4.9l-2.2-5.4L698.2,195z",
    MG: "M756.8,462l-2.2,3.2l-5.9-0.5l-5.4,3.2l-3.2-1.6l-3.2,2.2l-1.1,4.3l-5.9,2.7l-3.8-2.2l-4.3,0.5l-2.2,2.7l-5.4,0l-4.3,3.2l-7.6,1.1l-7,5.4l-3.8,4.9l-1.6-1.6l-6.5,0l-3.8,3.8l-5.4,1.6l-6.5-1.1l-6.5,4.9l-4.9,2.2l-7.6,5.4l-3.8,1.1l-3.2-1.6l-0.5,4.3l4.3,5.4l1.6,8.6l3.8,4.9l4.3,2.2l4.9-0.5l2.7-3.2l6.5,1.6l6.5,4.3l4.3,2.2l7.6,1.1l5.4-2.2l3.2,1.6l1.1-3.8l3.8-1.6l3.2,1.6l3.8-2.7l3.2,1.1l3.8-2.7l3.2,2.2l7.6-5.4l3.8,1.1l2.7,5.4l4.9-1.6l4.3,1.6l4.9-2.2l5.4,3.2l2.2-3.2l4.3,0l3.2-2.7l-0.5-4.9l3.2-4.3l3.8,1.1l1.6-4.3l5.9-1.1l1.6-3.8l-2.7-2.7l0.5-3.8l2.7-2.7l5.9-1.6l5.9-4.3l1.1-7l7-4.9l3.2-5.9l-2.2-1.6l-2.7,3.2l-3.8,2.2l-5.4,0.5l-1.6-3.8l-1.1,3.8l-2.7,4.3l-5.4,1.6l-4.3-1.6l-1.6,2.7l-5.4-1.1l-2.2,1.6l-5.9-1.6l-4.3,2.2l-5.9,0l-4.9-2.2l-3.8,1.1l-1.1-2.2l-4.3,1.6l-7-0.5l-3.8,3.8l-5.9-1.6l-3.2,3.8l-5.9-2.2l-8.1,1.6l-5.4-1.1l-4.9-6.5l-4.3-0.5l-2.7,3.8L756.8,462z",
    MS: "M556.1,571.4l-3.2,2.2l-4.3-1.6l-3.2,2.2l-4.3-2.7l-3.8,3.2l-4.9-1.1l-7,1.1l-5.4-3.2l-6.5,1.1l-3.8,5.4l-4.3-1.1l-5.4,3.8l-5.4,2.7l-4.9-1.1l-2.7-2.7l-3.2-1.1l-2.2,3.2l-3.8,2.7l-3.8-0.5l-4.9,3.2l-3.2-1.1l-5.4,2.7l-2.7,3.8l-0.5,4.9l2.7,3.8l0.5,7.6l4.3,0l2.7,2.2l7-3.2l5.9,1.6l2.7,3.8l2.2,6.5l5.9,3.8l5.9-2.2l4.9,4.9l11.9-2.7l8.1,1.6l8.1,5.4l5.4-2.2l1.1,3.2l1.6,8.1l4.3,4.9l5.4-0.5l3.2-3.8l4.3,2.7l4.3-1.1l2.7-3.8l4.9-2.2l3.8,2.7l10.3-6.5l4.3-6.5l-2.7-7l-2.7-2.7l-0.5-8.1l-5.4-4.3l-4.9-3.2l-2.2-4.3l-6.5-2.2l-3.2,3.8l-4.3-0.5l-3.2-5.9l-11.4-2.7l-3.8-7l-6.5-1.1l-2.7-5.9l-3.8-1.1l-3.2,2.2l-7-2.2l-3.8-4.3L556.1,571.4z",
    MT: "M444.4,361.4l-2.2,3.8l-2.7,1.1l-4.3-0.5l-3.8,1.6l-2.7,2.7l-4.3-1.1l-7-2.2l-4.9,1.6l-2.7,2.7l-3.8-1.1l-2.7,2.2l-3.2-1.6l-2.2,2.2l-3.2-1.6l-3.2,1.6l-2.2,4.3l-1.6,5.4l-5.9,1.6l-3.8-1.6l-1.6,4.3l-4.3,2.2l-6.5-2.2l-4.3,2.7l-3.8-1.1l-0.5,4.9l-4.9,1.6l-7,7.6l-1.6,4.3l1.1,3.8l5.4,1.6l1.6-3.2l3.8-1.1l2.7,3.2l4.3,0.5l1.6,2.7l2.2,7l5.4,2.2l6.5,0.5l3.2,2.2l4.9-1.1l3.8,3.2l5.4,1.6l5.9,4.3l3.8-2.2l4.9,4.3l1.6,3.8l5.4,0.5l4.3-2.2l3.8,1.1l7.6,0l5.4,3.8l3.8-1.1l4.3,1.6l2.7-2.2l5.9-2.7l2.7-4.9l5.4-3.8l1.6-3.2l-1.1-3.8l3.2-7l5.4-3.2l3.2-5.9l3.8-2.2l-3.2,3.2l-4.3-2.2l-5.4,1.1l-2.7-3.2l-3.8,0l-1.6-2.2l-3.8,1.6l-3.8-2.2l-1.6,2.2l-6.5-2.2l-2.7,1.6l-5.4-3.2l-2.7,2.7l-2.7-0.5l-2.2-3.8l-3.8,1.6l-4.9-3.8l-1.6-7.6l1.6-1.6l1.6-5.9l-2.7-10.3l-4.3-4.3l-10.8-2.7l-8.1,1.6l-5.9-1.6l-3.2,2.2l-7.6-3.8l-4.3,2.2l-4.3-2.2L444.4,361.4z",
    PA: "M667.9,173.4l-2.2,4.9l-4.9,2.2l-2.2,3.2l-1.1,7.6l-8.1,8.1l-1.6,7.6l-3.8,6.5l-10.3,1.6l-4.3,3.2l-4.9-0.5l-3.8,3.8l-3.2,0l-3.8,3.8l-3.2,3.8l2.7,2.7l5.4,2.2l4.3-2.2l6.5,1.6l3.8-2.2l5.4,2.2l3.2-1.6l5.4,3.2l1.6-1.6l2.7,2.2l5.9-1.1l2.7,3.8l4.3,1.1l5.9-2.7l8.6,2.2l3.2-2.7l4.3,1.6l8.1-3.8l3.8,3.2l10.3-3.2l2.7,3.2l7,0.5l5.4-4.3l3.8,1.6l3.8-3.8l0.5-4.3l4.3-1.6l8.1,2.7l2.7-2.2l5.4,2.2l5.9-0.5l1.6,4.3l4.3,1.1l4.9-1.6l4.9,3.2l6.5-2.7l5.4,5.4l3.8,0.5l5.4-1.6l0.5-2.2l3.8-2.2l2.2,2.2l2.7-0.5l1.6,1.6l2.7-2.2l3.8,1.1l3.8-2.7l5.9,5.4l7,1.1l2.2-2.7l2.2,2.7l7,3.2l5.4-3.2l5.4,2.2l2.2-6.5l8.1-1.6l11.9,2.7l2.2,5.4l-1.1,3.2l1.1,3.2l3.8,2.2l0.5,3.8l-4.9,2.7l-2.2,3.8l-3.2-1.6l-4.9,2.7l-1.1,3.8l-6.5,4.3l-1.6,5.9l-3.8,3.8l-1.6,4.9l-7,10.3l-7,4.3l-4.9-1.1l-2.7,1.6l-1.6,3.2l-7-3.2l-3.8,1.1l-2.7-2.7l-4.9-0.5l-2.7,2.2l-4.3-1.6l-3.2,1.6l-3.2-1.6l-5.9,1.6l-3.2-3.2l-3.8,1.6l-2.2-2.7l-4.9-0.5l-1.1-2.7l3.2-2.2l-0.5-4.3l-3.2-2.7l2.2-4.3l-1.1-3.8l-3.8,0.5l-2.2-4.9l-5.4-1.6l-4.3-6.5l-7-3.2l-0.5-3.8l5.4-5.9l4.3,0l1.6-1.6l2.2,1.6l3.2-1.1l1.6,2.7l5.4-4.9l4.9,1.6l5.9-3.2l2.2,2.7l3.2-2.2l2.7,2.2l4.3-1.6l2.2,3.8l3.8,0l2.7,2.7l3.2-1.6l2.2,2.2l2.2-0.5l5.4-10.3l5.4-3.2l4.9,3.2l2.2-2.2l3.2,3.2l3.2-1.6l2.2,2.2l7-3.2l4.3,2.7l3.8-1.1l2.2,5.9l4.9,0l3.2-3.2l0.5-3.8l-1.1-5.4l-4.9-2.7l-3.2,0.5l-4.3-2.2l-4.3,1.1l-1.6-2.7l-6.5,1.1l-1.6-4.9l-4.3-3.2l-11.9-2.2l-3.2-2.2l-2.7,2.2l-3.2-1.1l-4.3,1.6l-8.1,7.6l-4.3,0l-2.7-3.2l-5.9-1.1l-4.3,1.1l-2.7-2.7l-4.3-1.6l-2.7,3.2l-3.8-1.6l-2.2,3.2l-3.8-2.7l-3.8,0.5l-3.8-4.3l-4.9,1.6l-1.6-2.2l-11.4,4.3l-1.6,2.7L667.9,173.4z",
    PB: "M863.8,284.1l-5.4,0.5l-1.6-5.4l-2.2,0.5l-4.3-2.7l-3.2,3.8l-2.7-2.2l-5.4,1.6l-2.7-1.6l-5.9,1.1l-5.4-3.2l-2.7,3.2l-1.6-2.7l-2.2,2.2l-5.4-1.6l-3.8,3.2l-0.5,4.9l4.3,0.5l7.6,2.2l5.4-2.2l5.9,3.8l5.4-0.5l4.9,2.2l10.3-2.2l7-4.9l4.3,0.5L863.8,284.1z",
    PE: "M841.1,312.2l-2.2,1.1l-1.6-1.1l-1.1,2.2l-2.2-0.5l-2.7,2.7l-1.6-1.6l-1.6,1.6l-4.9-2.2l-5.4,0.5l-5.9-3.8l-5.4,2.2l-7.6-2.2l-4.3-0.5l0.5-4.9l3.8-3.2l5.4,1.6l2.2-2.2l1.6,2.7l2.7-3.2l5.4,3.2l5.9-1.1l2.7,1.6l5.4-1.6l2.7,2.2l3.2-3.8l4.3,2.7l2.2-0.5l1.6,5.4l5.4-0.5l0.5,5.4l2.2,4.3l-2.7,2.2l-1.1-2.2l-2.7,1.6L841.1,312.2z",
    PI: "M774.2,240.9l-5.9,2.2l-2.7,3.8l-5.4,1.1l-5.9-2.7l-4.9,1.6l-2.2,6.5l-4.3,5.4l1.1,3.8l7,1.6l2.2-4.3l4.9,0l4.3,1.6l4.9-2.2l3.8,3.2l4.3-1.6l5.4,2.2l5.4-1.1l5.4,2.7l4.3-1.6l3.8,1.6l7-1.1l4.3,2.7l5.9-1.1l1.6,4.9l4.3-1.6l4.9,2.2l4.3-2.7l1.6-3.8l-3.8-1.1l-1.1-3.8l-5.4-1.1l-2.7-3.8l0.5-4.9l3.8-3.2l5.4,1.6l2.2-2.2l-7.6-6.5l-2.7,1.1l-2.2-1.6l-3.8,0.5l-2.2-3.8l-5.4-2.7l-3.2,2.2l-4.9-1.6l-2.7,1.6l-1.1-2.7l-4.9,1.1l-3.8-2.2l-1.1-2.2l-4.3,2.2l-5.9-2.7L774.2,240.9z",
    PR: "M593.5,641.1l-2.2-2.7l-7,1.6l-6.5-3.8l-4.3-6.5l-7.6-2.2l-4.3,4.9l-4.9,0.5l-5.4,4.3l-0.5,3.8l-4.9,3.2l-3.2-0.5l-5.9,4.9l-8.1-3.2l-5.9,1.1l-4.9-3.8l-3.2,0.5l-2.7,4.3l-4.3,1.1l-1.6,3.2l-2.7-1.6l-4.9,2.7l-3.8-1.6l-2.2-2.7l-4.9,4.9l-5.9-3.8l-2.2-6.5l-2.7-3.8l-5.9-1.6l-7,3.2l-2.7-2.2l-4.3,0l-0.5-7.6l8.1-2.2l8.1-4.3l5.4,2.2l7-3.2l2.7-4.3l3.2-1.6l3.2,1.6l10.3-5.4l10.3-3.2l9.2,2.7l4.9-1.6l8.6,3.2l5.4-2.2l5.4,2.7l11.9,2.2l4.3-2.2l3.8,2.2l4.9,0.5l2.2,4.3l7,5.9l8.1,0l4.3,3.2l6.5,8.1l3.8,1.1l2.2,4.3l2.2-0.5l0.5,3.8l-1.6,3.2L593.5,641.1z",
    RJ: "M781.6,561.2l-1.6,0.5l-3.2-2.7l-6.5,2.7l-5.9-0.5l-4.3,1.6l-7.6-2.7l-5.4-4.3l-2.2-3.2l-2.7,1.1l-5.4-5.9l-1.1-4.3l6.5-4.9l6.5,1.1l5.4-1.6l3.8-3.8l6.5,0l1.6,1.6l3.8-4.9l7-5.4l7.6-1.1l4.3-3.2l5.4,0l2.2-2.7l4.3-0.5l3.8,2.2l5.9-2.7l1.1-4.3l3.2-2.2l3.2,1.6l5.4-3.2l5.9,0.5l2.2-3.2l1.6-0.5l-4.3,13l-11.4,9.7l-10.8,7l-14.6,5.9L781.6,561.2z",
    RN: "M864.9,259.2l-3.8,3.2l-1.1,4.3l-2.2,1.1l-0.5,4.9l-4.3,1.6l-5.4-2.7l-5.4,1.1l-5.4-2.2l-4.3,1.6l-3.8-3.2l-4.9,2.2l-4.3-1.6l-4.9,0l-2.2,4.3l-7-1.6l-1.1-3.8l4.3-5.4l2.2-6.5l4.9-1.6l5.9,2.7l5.4-1.1l2.7-3.8l5.9-2.2l6.5,2.2l5.9-1.1l4.3,2.7l3.2-2.2l5.9,2.7l5.4-2.2L864.9,259.2z",
    RO: "M278.2,479.3l-2.2-2.7l-5.4,1.6l-1.6-3.2l-4.9,0l-3.8-3.2l-2.2,2.2l-3.8-1.6l-4.3-5.4l-4.3-1.6l-1.6-3.2l-7-2.7l-7-7l-2.7-7l0.5-4.9l2.7-2.2l3.8,2.7l6.5,0l5.9-2.7l2.7-4.9l5.4-3.8l1.6-3.2l-1.1-3.8l3.2-7l5.4-3.2l3.2-5.9l-3.8-2.2l-3.2,3.2l-4.3-2.2l-5.4,1.1l-2.7-3.2l-3.8,0l-1.6-2.2l-3.8,1.6l-3.8-2.2l-1.6,2.2l-6.5-2.2l-2.7,1.6l-5.4-3.2l-2.7,2.7l-2.7-0.5l-2.2-3.8l-3.8,1.6l-4.9-3.8l-1.6-7.6l1.6-1.6l1.6-5.9l2.7-10.3l-4.3-4.3l-10.8-2.7l-8.1,1.6l-5.9-1.6l-3.2,2.2l-7.6-3.8l-4.3,2.2l-4.3-2.2l-1.1-3.2l-4.3,1.1l-1.1-4.3l-3.8,1.1l-2.2-1.6l-3.8,2.7l-5.4-1.1l-2.2,2.7l-4.9-0.5l-1.1-3.2l-2.7,1.1l-4.3-1.1l-5.9,2.7l-1.6,3.2l-5.4-1.1l-2.7,2.2l-0.5,3.8l-3.8-1.1l-2.7-3.2l-3.8-0.5l-4.3,3.8l-2.2-1.1l-2.2-5.4l-7-4.9l-5.4,0l-4.3-6.5l-7-2.7l-5.4,2.2l-4.3-2.7l-2.7,2.7l-4.9-3.2l-8.1,1.1l-7,3.2l-1.1,3.8l1.6,2.7l-3.2,4.3l-4.9,2.2l0.5,3.8l5.9,2.2l2.2,3.2l-1.1,7.6l-8.1,8.1l-1.6,7.6l-3.8,6.5l-10.3,1.6l-4.3,3.2l-4.9-0.5l-3.8,3.8l-3.2,0l-3.8,3.8l-3.2,3.8l2.7,2.7l5.4,2.2l4.3-2.2l6.5,1.6l3.8-2.2l5.4,2.2l3.2-1.6l5.4,3.2l1.6-1.6l2.7,2.2l5.9-1.1l2.7,3.8l4.3,1.1l5.9-2.7l8.6,2.2l3.2-2.7l4.3,1.6l8.1-3.8l3.8,3.2l10.3-3.2l2.7,3.2l7,0.5l5.4-4.3l3.8,1.6l3.8-3.8l0.5-4.3l4.3-1.6l8.1,2.7l2.7-2.2l5.4,2.2l5.9-0.5l1.6,4.3l4.3,1.1l4.9-1.6l4.9,3.2l6.5-2.7l5.4,5.4l3.8,0.5l5.4-1.6l0.5-2.2l3.8-2.2l2.2,2.2l2.7-0.5l1.6,1.6l2.7-2.2l3.8,1.1l3.8-2.7l5.9,5.4l7,1.1l2.2-2.7l2.2,2.7l7,3.2l5.4-3.2l5.4,2.2l2.2-6.5l8.1-1.6l11.9,2.7l2.2,5.4l-1.1,3.2l1.1,3.2l3.8,2.2l0.5,3.8l-4.9,2.7l-2.2,3.8l-3.2-1.6l-4.9,2.7l-1.1,3.8l-6.5,4.3l-1.6,5.9l-3.8,3.8l-1.6,4.9l-7,10.3l-7,4.3l-4.9-1.1l-2.7,1.6l-1.6,3.2l-7-3.2l-3.8,1.1l-2.7-2.7l-4.9-0.5l-2.7,2.2l-4.3-1.6l-3.2,1.6l-3.2-1.6l-5.9,1.6l-3.2-3.2l-3.8,1.6l-2.2-2.7l-4.9-0.5l-1.1-2.7l3.2-2.2l-0.5-4.3l-3.2-2.7l2.2-4.3l-1.1-3.8l-3.8,0.5l-2.2-4.9l-5.4-1.6l-4.3-6.5l-7-3.2l-0.5-3.8l5.4-5.9l4.3,0l1.6-1.6l2.2,1.6l3.2-1.1l1.6-2.7l5.4-4.9l4.9,1.6l5.9-3.2l2.2,2.7l3.2-2.2l2.7,2.2l4.3-1.6l2.2,3.8l3.8,0l2.7,2.7l3.2-1.6l2.2,2.2l2.2-0.5l5.4-10.3l5.4-3.2l4.9,3.2l2.2-2.2l3.2,3.2l3.2-1.6l2.2,2.2l7-3.2l4.3,2.7l3.8-1.1l2.2,5.9l4.9,0l3.2-3.2l0.5-3.8l-1.1-5.4l-4.9-2.7l-3.2,0.5l-4.3-2.2l-4.3,1.1l-1.6-2.7l-6.5,1.1l-1.6-4.9l-4.3-3.2l-11.9-2.2l-3.2-2.2l-2.7,2.2l-3.2-1.1l-4.3,1.6l-8.1,7.6l-4.3,0l-2.7-3.2l-5.9-1.1l-4.3,1.1l-2.7-2.7l-4.3-1.6l-2.7,3.2l-3.8-1.6l-2.2,3.2l-3.8-2.7l-3.8,0.5l-3.8-4.3l-4.9,1.6l-1.6-2.2l-11.4,4.3l-1.6,2.7L278.2,479.3z",
    RR: "M338.7,94.7l-5.4,1.1l-2.7,1.6l-2.2,2.7l-3.8,1.6l-3.2,3.2l-4.3,2.2l-5.4,1.1l-2.7-3.2l-3.8,0l-1.6-2.2l-3.8,1.6l-3.8-2.2l-1.6,2.2l-6.5-2.2l-2.7,1.6l-5.4-3.2l-2.7,2.7l-2.7-0.5l-2.2-3.8l-3.8,1.6l-4.9-3.8l-1.6-7.6l1.6-1.6l1.6-5.9l2.7-10.3l-4.3-4.3l-10.8-2.7l-8.1,1.6l-5.9-1.6l-3.2,2.2l-7.6-3.8l-4.3,2.2l-4.3-2.2l-1.1-3.2l-4.3,1.1l-1.1-4.3l-3.8,1.1l-2.2-1.6l-3.8,2.7l-5.4-1.1l-2.2,2.7l-4.9-0.5l-1.1-3.2l-2.7,1.1l-4.3-1.1l-5.9,2.7l-1.6,3.2l-5.4-1.1l-2.7,2.2l-0.5,3.8l-3.8-1.1l-2.7-3.2l-3.8-0.5l-4.3,3.8l-2.2-1.1l-2.2-5.4l-7-4.9l-5.4,0l-4.3-6.5l-7-2.7l-5.4,2.2l-4.3-2.7l-2.7,2.7l-4.9-3.2l-8.1,1.1l-7,3.2l-1.1,3.8l1.6,2.7l-3.2,4.3l-4.9,2.2l0.5,3.8l5.9,2.2l2.2,3.2l-1.1,7.6l-8.1,8.1l-1.6,7.6l-3.8,6.5l-10.3,1.6l-4.3,3.2l-4.9-0.5l-3.8,3.8l-3.2,0l-3.8,3.8l-3.2,3.8l2.7,2.7l5.4,2.2l4.3-2.2l6.5,1.6l3.8-2.2l5.4,2.2l3.2-1.6l5.4,3.2l1.6-1.6l2.7,2.2l5.9-1.1l2.7,3.8l4.3,1.1l5.9-2.7l8.6,2.2l3.2-2.7l4.3,1.6l8.1-3.8l3.8,3.2l10.3-3.2l2.7,3.2l7,0.5l5.4-4.3l3.8,1.6l3.8-3.8l0.5-4.3l4.3-1.6l8.1,2.7l2.7-2.2l5.4,2.2l5.9-0.5l1.6,4.3l4.3,1.1l4.9-1.6l4.9,3.2l6.5-2.7l5.4,5.4l3.8,0.5l5.4-1.6l0.5-2.2l3.8-2.2l2.2,2.2l2.7-0.5l1.6,1.6l2.7-2.2l3.8,1.1l3.8-2.7l5.9,5.4l7,1.1l2.2-2.7l2.2,2.7l7,3.2l5.4-3.2l5.4,2.2l2.2-6.5l8.1-1.6l11.9,2.7l2.2,5.4l-1.1,3.2l1.1,3.2l3.8,2.2l0.5,3.8l-4.9,2.7l-2.2,3.8l-3.2-1.6l-4.9,2.7l-1.1,3.8l-6.5,4.3l-1.6,5.9l-3.8,3.8l-1.6,4.9l-7,10.3l-7,4.3l-4.9-1.1l-2.7,1.6l-1.6,3.2l-7-3.2l-3.8,1.1l-2.7-2.7l-4.9-0.5l-2.7,2.2l-4.3-1.6l-3.2,1.6l-3.2-1.6l-5.9,1.6l-3.2-3.2l-3.8,1.6l-2.2-2.7l-4.9-0.5l-1.1-2.7l3.2-2.2l-0.5-4.3l-3.2-2.7l2.2-4.3l-1.1-3.8l-3.8,0.5l-2.2-4.9l-5.4-1.6l-4.3-6.5l-7-3.2l-0.5-3.8l5.4-5.9l4.3,0l1.6-1.6l2.2,1.6l3.2-1.1l1.6-2.7l5.4-4.9l4.9,1.6l5.9-3.2l2.2,2.7l3.2-2.2l2.7,2.2l4.3-1.6l2.2,3.8l3.8,0l2.7,2.7l3.2-1.6l2.2,2.2l2.2-0.5l5.4-10.3l5.4-3.2l4.9,3.2l2.2-2.2l3.2,3.2l3.2-1.6l2.2,2.2l7-3.2l4.3,2.7l3.8-1.1l2.2,5.9l4.9,0l3.2-3.2l0.5-3.8l-1.1-5.4l-4.9-2.7l-3.2,0.5l-4.3-2.2l-4.3,1.1l-1.6-2.7l-6.5,1.1l-1.6-4.9l-4.3-3.2l-11.9-2.2l-3.2-2.2l-2.7,2.2l-3.2-1.1l-4.3,1.6l-8.1,7.6l-4.3,0l-2.7-3.2l-5.9-1.1l-4.3,1.1l-2.7-2.7l-4.3-1.6l-2.7,3.2l-3.8-1.6l-2.2,3.2l-3.8-2.7l-3.8,0.5l-3.8-4.3l-4.9,1.6l-1.6-2.2l-11.4,4.3l-1.6,2.7L338.7,94.7z",
    RS: "M541,745.4l-2.7-2.2l-5.4-2.7l-5.9,3.2l-9.2-2.2l-3.8,4.3l-8.6,2.2l-5.4,4.3l-9.7,5.4l-6.5,1.6l-10.8,6.5l-6.5,3.2l-4.9,3.8l-2.2,0.5l-2.7,3.8l-2.7-1.6l-2.2,1.1l-2.7-3.8l-4.3-1.1l-3.2,0.5l-4.9,3.8l-4.3-0.5l-2.7,1.6l-7-2.2l-4.9,1.6l-6.5-1.6l-4.9-2.7l-4.9-1.1l-6.5,2.7l-2.7-2.2l-2.2,1.6l-0.5-4.9l-3.8-1.6l-4.3,1.1l-1.6-4.3l-4.9-3.8l-3.2,1.6l-3.2-1.6l-1.6,1.6l-2.7-2.7l-3.8-0.5l-2.2,3.2l-2.7-2.2l-3.2,2.2l-2.2-2.7l-2.2,1.1l-1.6-1.1l-1.6,2.2l-3.8,0.5l-2.7-4.3l-7.6-5.9l-1.1-2.7l2.2-5.4l2.7-1.6l7-3.2l5.9,1.6l2.7,3.8l2.2,6.5l5.9,3.8l4.9-4.9l2.2,2.7l3.8,1.6l4.9-2.7l2.7,1.6l1.6-3.2l4.3-1.1l2.7-4.3l3.2-0.5l4.9,3.8l5.9-1.1l8.1,3.2l5.9-4.9l3.2,0.5l4.9-3.2l0.5-3.8l5.4-4.3l4.9-0.5l4.3-4.9l7.6,2.2l4.3,6.5l6.5,3.8l7-1.6l2.2,2.7l1.6-3.2l2.2,2.2l3.2-2.7l8.6-1.6l5.4,3.2l5.4,0l6.5-3.2l3.2,1.6l4.3-3.2l3.8,3.8l7.6,1.1l3.8-2.2l2.7,2.2l4.9,0.5l1.1,3.2l5.4,3.8l3.8-1.1l3.8,3.8l4.3-1.1l4.3,5.4l4.9,2.2L541,745.4z",
    SC: "M589.2,669.2l-1.1,4.3l-5.9,2.7l-3.8-2.2l-4.3,0.5l-2.2,2.7l-5.4,0l-4.3,3.2l-7.6,1.1l-7,5.4l-3.8,4.9l-1.6-1.6l-6.5,0l-3.8,3.8l-5.4,1.6l-6.5-1.1l-6.5,4.9l-4.9,2.2l-7.6,5.4l-3.8,1.1l-3.2-1.6l-0.5,4.3l4.3,5.4l1.6,8.6l3.8,4.9l4.3,2.2l4.9-0.5l2.7-3.2l6.5,1.6l6.5,4.3l4.3,2.2l7.6,1.1l5.4-2.2l3.2,1.6l1.1-3.8l3.8-1.6l3.2,1.6l3.8-2.7l3.2,1.1l3.8-2.7l3.2,2.2l7.6-5.4l3.8,1.1l2.7,5.4l4.9-1.6l4.3,1.6l4.9-2.2l5.4,3.2l2.2-3.2l4.3,0l3.2-2.7l-0.5-4.9l3.2-4.3l3.8,1.1l1.6-4.3l5.9-1.1l1.6-3.8l-2.7-2.7l0.5-3.8l2.7-2.7l5.9-1.6l5.9-4.3l1.1-7l7-4.9l3.2-5.9l-2.2-1.6l-2.7,3.2l-3.8,2.2l-5.4,0.5l-1.6-3.8l-1.1,3.8l-2.7,4.3l-5.4,1.6l-4.3-1.6l-1.6,2.7l-5.4-1.1l-2.2,1.6l-5.9-1.6l-4.3,2.2l-5.9,0l-4.9-2.2l-3.8,1.1l-1.1-2.2l-4.3,1.6l-7-0.5l-3.8,3.8l-5.9-1.6l-3.2,3.8l-5.9-2.2l-8.1,1.6l-5.4-1.1l-4.9-6.5l-4.3-0.5l-2.7,3.8L589.2,669.2z",
    SE: "M855.6,414.4l-1.1,1.6l-2.7,0.5l-0.5,3.8l2.2,2.2l3.2,1.6l4.3,2.2l5.9,0.5l0.5-4.3l-3.2-5.4l-1.1-3.2L855.6,414.4z",
    SP: "M636.1,557.7l-2.7,3.2l-4.9-1.1l-2.7-3.8l-8.1-1.1l-4.9,2.2l-6.5-2.7l-4.3,1.6l-5.4-3.2l-1.6,1.6l-3.8-1.1l-3.2,1.6l-4.9-1.1l-3.8,1.1l-3.8-3.2l-2.2,1.6l-3.2-1.6l-2.2,2.7l-4.9,0.5l-3.8-2.2l-0.5,3.8l-4.3,0.5l-2.2,3.2l-5.9,1.1l-4.3-2.2l-2.2,1.6l-4.3-1.1l-1.6,2.7l-6.5,0l-2.7,4.3l2.2,5.4l5.4,1.1l4.3,6.5l-2.7,3.8l1.6,4.3l4.9,4.3l5.4-2.2l3.8,4.3l7,2.2l3.2-2.2l3.8,1.1l2.7,5.9l6.5,1.1l3.8,7l11.4,2.7l3.2,5.9l4.3,0.5l3.2-3.8l6.5,2.2l1.6-3.2l4.3,0l3.8-4.9l5.9-2.2l2.7-3.8l5.4,0.5l3.2-2.2l-2.2-2.7l-3.8-0.5l-2.2,2.2l0.5,3.2l4.3-0.5l4.3-2.2l2.7-3.8l4.9,2.7l3.8-3.8l-4.9-10.8l2.2-4.3l0.5-7l-1.1-3.2l-5.4-1.6l-2.2-4.3L636.1,557.7z",
    TO: "M635,279.3l-3.2,1.6l-1.1,3.2l-4.3,1.6l-3.2-2.2l-0.5-5.4l-5.4,0.5l-1.6-5.4l-2.2,0.5l-4.3-2.7l-3.2,3.8l-2.7-2.2l-5.4,1.6l-2.7-1.6l-5.9,1.1l-5.4-3.2l-2.7,3.2l-1.6-2.7l-2.2,2.2l-5.4-1.6l-3.8,3.2l-0.5,4.9l2.7,3.8l5.4,1.1l1.1,3.8l3.8,1.1l1.6,3.8l-4.3,2.7l-4.9-2.2l-4.3,1.6l-1.6-4.9l-5.9,1.1l-4.3-2.7l-7,1.1l-3.8-1.6l-4.3,1.6l-5.4-2.7l-5.4,1.1l-5.4-2.2l-4.3,1.6l-3.8-3.2l-4.9,2.2l-4.3-1.6l-4.9,0l-2.2,4.3l-7-1.6l-1.1-3.8l4.3-5.4l2.2-6.5l4.9-1.6l5.9,2.7l5.4-1.1l2.7-3.8l5.9-2.2lL635,279.3z"
};

interface BrazilMapProps {
    data: BrazilStateMetric[];
}

export const BrazilMap: React.FC<BrazilMapProps> = ({ data }) => {
    const [hoveredState, setHoveredState] = useState<string | null>(null);
    const [tooltipPos, setTooltipPos] = useState({ x: 0, y: 0 });
    const [scale, setScale] = useState(1);
    const [translate, setTranslate] = useState({ x: 0, y: 0 });
    const [isDragging, setIsDragging] = useState(false);
    const [dragStart, setDragStart] = useState({ x: 0, y: 0 });

    // Determine color intensity based on visitors
    const maxVisitors = Math.max(...data.map(d => d.visitors), 1000);
    
    const getColor = (stateId: string) => {
        const stateData = data.find(d => d.id === stateId);
        if (!stateData) return '#e2e8f0'; // default gray for no data

        const intensity = stateData.visitors / maxVisitors;
        
        // Generate a blue/indigo shade based on intensity
        // Light: #e0e7ff (Indigo 100) to Dark: #312e81 (Indigo 900)
        if (intensity < 0.05) return '#e0e7ff';
        if (intensity < 0.15) return '#c7d2fe';
        if (intensity < 0.3) return '#a5b4fc';
        if (intensity < 0.5) return '#818cf8';
        if (intensity < 0.7) return '#6366f1';
        if (intensity < 0.9) return '#4f46e5';
        return '#312e81';
    };

    const handleMouseEnter = (e: React.MouseEvent, stateId: string) => {
        setHoveredState(stateId);
    };

    const handleMouseMove = (e: React.MouseEvent) => {
        // Get the position relative to the container
        const rect = e.currentTarget.getBoundingClientRect();
        setTooltipPos({
            x: e.clientX - rect.left,
            y: e.clientY - rect.top
        });
    };

    const handleMouseLeave = () => {
        setHoveredState(null);
    };

    const handleZoomIn = () => setScale(prev => Math.min(prev + 0.5, 4));
    const handleZoomOut = () => {
        setScale(prev => {
            const newScale = Math.max(prev - 0.5, 1);
            if (newScale === 1) setTranslate({ x: 0, y: 0 }); // Reset position on full zoom out
            return newScale;
        });
    };

    // Drag Logic
    const handleMouseDown = (e: React.MouseEvent) => {
        if (scale > 1) {
            setIsDragging(true);
            setDragStart({ x: e.clientX - translate.x, y: e.clientY - translate.y });
        }
    };

    const handleDragMove = (e: React.MouseEvent) => {
        if (isDragging && scale > 1) {
            setTranslate({
                x: e.clientX - dragStart.x,
                y: e.clientY - dragStart.y
            });
        }
    };

    const handleMouseUp = () => {
        setIsDragging(false);
    };

    const getTooltipData = () => {
        if (!hoveredState) return null;
        return data.find(d => d.id === hoveredState);
    };

    const tooltipData = getTooltipData();

    return (
        <div className="relative w-full h-full overflow-hidden bg-slate-50 dark:bg-slate-800/50 rounded-lg">
            {/* Map Controls */}
            <div className="absolute top-4 right-4 flex flex-col gap-2 z-10">
                <button onClick={handleZoomIn} className="p-2 bg-white dark:bg-slate-700 rounded shadow hover:bg-gray-100 dark:hover:bg-slate-600 text-text-primary-light dark:text-text-primary-dark font-bold">
                    +
                </button>
                <button onClick={handleZoomOut} className="p-2 bg-white dark:bg-slate-700 rounded shadow hover:bg-gray-100 dark:hover:bg-slate-600 text-text-primary-light dark:text-text-primary-dark font-bold">
                    -
                </button>
            </div>

            {/* SVG Container */}
            <div 
                className={`w-full h-full flex items-center justify-center ${isDragging ? 'cursor-grabbing' : scale > 1 ? 'cursor-grab' : 'cursor-default'}`}
                onMouseMove={(e) => { handleMouseMove(e); handleDragMove(e); }}
                onMouseDown={handleMouseDown}
                onMouseUp={handleMouseUp}
                onMouseLeave={() => { handleMouseLeave(); handleMouseUp(); }}
            >
                <svg
                    viewBox="100 0 800 800" // Adjusted viewBox for better framing of Brazil paths
                    className="w-full h-full transition-transform duration-200 ease-out"
                    style={{ transform: `translate(${translate.x}px, ${translate.y}px) scale(${scale})` }}
                >
                    {Object.entries(statePaths).map(([id, path]) => (
                        <path
                            key={id}
                            d={path}
                            fill={getColor(id)}
                            stroke="#ffffff"
                            strokeWidth={1 / scale} // Keep stroke width constant visually
                            className="transition-colors duration-200 hover:opacity-80 outline-none"
                            onMouseEnter={(e) => handleMouseEnter(e, id)}
                        />
                    ))}
                </svg>
            </div>

            {/* Tooltip */}
            {hoveredState && tooltipData && (
                <div
                    className="absolute pointer-events-none bg-black/80 text-white text-xs rounded px-2 py-1 z-20 whitespace-nowrap"
                    style={{
                        left: tooltipPos.x + 10,
                        top: tooltipPos.y - 10,
                    }}
                >
                    <div className="font-bold">{tooltipData.name}</div>
                    <div>{tooltipData.visitors.toLocaleString('pt-BR')} visitantes</div>
                </div>
            )}
             {hoveredState && !tooltipData && (
                <div
                    className="absolute pointer-events-none bg-black/80 text-white text-xs rounded px-2 py-1 z-20 whitespace-nowrap"
                    style={{
                        left: tooltipPos.x + 10,
                        top: tooltipPos.y - 10,
                    }}
                >
                    <div className="font-bold">{hoveredState}</div>
                    <div className="italic">Sem dados</div>
                </div>
            )}
            
            {/* Legend/Info */}
            <div className="absolute bottom-4 left-4 bg-white/80 dark:bg-slate-900/80 p-2 rounded text-xs text-text-secondary-light dark:text-text-secondary-dark backdrop-blur-sm">
                 <div className="flex items-center gap-2 mb-1">
                    <div className="w-3 h-3 bg-[#4f46e5]"></div> <span>Alto Volume</span>
                 </div>
                 <div className="flex items-center gap-2">
                    <div className="w-3 h-3 bg-[#e0e7ff]"></div> <span>Baixo Volume</span>
                 </div>
            </div>
        </div>
    );
};